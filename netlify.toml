# ============================
# âœ… Netlify Build Configuration
# ============================

[build]
  # The folder Netlify will deploy publicly (for static files)
  publish = "public"

  # No frontend build step (serverless backend only)
  command = "echo 'No frontend build step needed'"

# ============================
# âœ… Serverless Functions Setup
# ============================
[functions]
  # ðŸš¨ Point directly to the backend functions folder
  directory = "vitalink-backend/functions"

  # Use esbuild for fast bundling
  node_bundler = "esbuild"

  # âœ… Include all Node dependencies that your functions import
  external_node_modules = [
    "pg",          # PostgreSQL
    "nodemailer",  # Email sending
    "qrcode",      # QR code generation
    "bcryptjs",    # Password hashing
    "sharp",       # Image processing
    "twilio"       # SMS service for password resets
  ]

# ============================
# âœ… Environment Configuration
# ============================
[build.environment]
  NODE_VERSION = "20"

  # Email sending configuration (do NOT include password here)
  SMTP_HOST = "smtp.gmail.com"
  SMTP_PORT = "587"
  SMTP_USER = "ehevelone@gmail.com"

  # ðŸš¨ IMPORTANT:
  # Keep all secrets like SMTP_PASS, OPENAI_API_KEY, SUPABASE_URL, etc.
  # inside Netlify â†’ Site Settings â†’ Environment Variables.
  # Never hardcode passwords or keys into this file.
