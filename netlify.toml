# ============================
# ✅ Netlify Build Configuration
# ============================

[build]
  # The folder Netlify will deploy publicly (for static files)
  publish = "public"

  # No frontend build step (backend only project)
  command = "echo 'No frontend build step needed'"

# ============================
# ✅ Serverless Functions Setup
# ============================
[functions]
  # Folder containing all your Netlify Functions
  directory = "functions"

  # Use esbuild for fast bundling
  node_bundler = "esbuild"

  # ✅ Include all Node dependencies that your functions import
  external_node_modules = [
    "pg",          # PostgreSQL
    "nodemailer",  # Email sending
    "qrcode",      # QR code generation
    "bcryptjs",    # Password hashing
    "sharp",       # Image processing
    "twilio"       # SMS service (future use)
  ]

# ============================
# ✅ Environment Configuration
# ============================
[build.environment]
  NODE_VERSION = "20"

  # Gmail SMTP config (password stays in Netlify env settings)
  SMTP_HOST = "smtp.gmail.com"
  SMTP_PORT = "587"
  SMTP_USER = "ehevelone@gmail.com"

# ============================
# ✅ Local Development Settings
# ============================
[dev]
  # Port where Netlify Dev proxy will run
  port = 8888

  # Internal port for functions to run on
  targetPort = 9999

  # Point to the correct functions folder
  functions = "functions"
